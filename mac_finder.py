from multiprocessing import Process
from scapy.all import *
import os
import sys
import time
import threading
f1=open('mac_list.txt','w')
def get_mac1(targetip):
    packet = Ether(dst='ff:ff:ff:ff:ff:ff')/ARP(op="who-has", pdst=targetip)
    resp, _ = srp(packet, timeout=2, retry=10, verbose=False)
    
    for _, r in resp:
        m=r[Ether].src
        f1.write(targetip+" "+m+"\n")
        
       
def main():
    f=open('target.txt','r')
    data=f.read()
    for i in data.split():
        print(i)
        t=threading.Thread(target=get_mac1,args=(i,))
        t.start()
    time.sleep(10)
    f.close()
    time.sleep(10)

main()
    
