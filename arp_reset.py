from multiprocessing import Process
from scapy.all import *
import os
import sys
import time
import threading
import arp_reset as restore
def restore(target,mac,gate_way_ip,gate_way_MAC):
    send(ARP(
        op=2,
            psrc=gate_way_ip,
            hwsrc=gate_way_MAC,
            pdst=target,
            hwdst='ff:ff:ff:ff:ff:ff'),
            count=5)
    send(ARP(
            op=2,
            psrc=target,
            hwsrc=mac,
            pdst=gate_way_ip,
            hwdst='ff:ff:ff:ff:ff:ff'),
            count=5)
    print("restored configration for  {}".format(target))
def arp_main(gate_way_ip,gate_way_mac):
    
    f1=open("mac_list.txt",'r')
    data=f1.readlines()
    for line in data:
        t=line.split(" ")
        target_ip=t[0]
        target_mac=t[1]
        t=threading.Thread(target=restore,args=(target_ip,target_mac,gate_way_ip,gate_way_mac))
        t.start()
        time.sleep(2)



