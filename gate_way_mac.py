from multiprocessing import Process
from scapy.all import *
import os
import sys
import time
import threading
def get_mac(targetip):
    packet = Ether(dst='ff:ff:ff:ff:ff:ff')/ARP(op="who-has", pdst=targetip)
    resp, _ = srp(packet, timeout=2, retry=10, verbose=False)
    for _, r in resp:
        return r[Ether].src
    
ip='192.168.1.1'
mac=get_mac(ip)
print(mac)
